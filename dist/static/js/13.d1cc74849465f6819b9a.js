webpackJsonp([13],{"97zH":function(e,t){e.exports={data:{totalPages:34,page:1,content:[{updateUserName:"管理员",typeName:"",count:1,updateUser:"1",modelMap:'{"id":"ff80808176e0ec700176fec52f7f06f6","name":"演示例子10","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":0,"factType":"AlarmEvent","window":"","after":"","objBindName":"$AE1","junctionType":"","note":"","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"$AE1S1","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:DMZ\\")","fieldBindName":"$AE1D1","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"SQL注入","fieldBindName":"$AE1L1","junctionType":"","dataType":"0","constraintList":[]}]},{"type":0,"factType":"AlarmEvent","window":"","after":"[0h0m3s] $AE1","objBindName":"$AE2","junctionType":"","note":"","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"$AE2S1","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:DMZ\\")","fieldBindName":"$AE2D1","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"webshell攻击","fieldBindName":"$AE2L1","junctionType":"","dataType":"0","constraintList":[]}]},{"type":0,"factType":"AlarmEvent","window":"","after":"[0h0m0s,2h0m0s] $AE2","objBindName":"$AE3","junctionType":"","note":"","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:DMZ\\")","fieldBindName":"$AE3S1","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"$AE3D1","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"脆弱口令","fieldBindName":"$AE3L1","junctionType":"","dataType":"0","constraintList":[]}]},{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"over window:time(0h40m0s)","after":"","objBindName":"$AE4","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"网络通信","fieldBindName":"$AE4L1","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"$AE4S1","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"$AE4D1","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"$AE4S2","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"$AE4D2","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"$AE4S3","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"$AE4D3","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"$AE4S4","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"$AE4D4","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"数据窃取事件","value":5},{"key":"reportName","value":"演示例子10"},{"key":"reportLevel","value":"0"},{"key":"reportStatus","value":"0"},{"key":"advice","value":"离线受害资产"},{"key":"analyzePro","value":"专家分析"},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":"SUSSC2"},{"key":"count","value":"$count"},{"key":"attackResult","value":"成功"},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"2021-01-22 14:33:20",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:4,isExtend:!1,createTime:"2021-01-14 10:41:52",typeId:"",createUser:"1",id:"ff80808176e0ec700176fec52f7f06f6",drl:'package rules;\n\nrule "演示例子10"\n\tdialect "mvel"\n\twhen\n\t\t$AE1 : AlarmEvent( $AE1S1 : srcIp not memberOf (poolmap.get("内网集合")) , $AE1D1 : desIp memberOf (poolmap.get("DMZ")) , $AE1L1 : labels contains "SQL注入" ) from entry-point "alarmEventEntry"\n\t\t$AE2 : AlarmEvent( this after [0h0m3s] $AE1 , $AE2S1 : srcIp not memberOf (poolmap.get("内网集合")) , $AE2D1 : desIp memberOf (poolmap.get("DMZ")) , $AE2L1 : labels contains "webshell攻击" ) from entry-point "alarmEventEntry"\n\t\t$AE3 : AlarmEvent( this after [0h0m0s,2h0m0s] $AE2 , $AE3S1 : srcIp memberOf (poolmap.get("DMZ")) , $AE3D1 : desIp memberOf (poolmap.get("办公区")) , $AE3L1 : labels contains "脆弱口令" ) from entry-point "alarmEventEntry"\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\t$AE4 : AlarmEvent( ( $AE4L1 : labels contains "网络通信" )&& ( ( ( $AE4S1 : srcIp memberOf (poolmap.get("生产区")) )&& ( $AE4D1 : desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( $AE4S2 : srcIp memberOf (poolmap.get("办公区")) )&& ( $AE4D2 : desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( $AE4S3 : srcIp not memberOf (poolmap.get("内网集合")) )&& ( $AE4D3 : desIp memberOf (poolmap.get("生产区")) ))|| ( ( $AE4S4 : srcIp not memberOf (poolmap.get("内网集合")) )&& ( $AE4D4 : desIp memberOf (poolmap.get("办公区")) )))) over window:time(0h40m0s) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"attackResult\\":\\"成功\\",\\"reportName\\":\\"演示例子10\\",\\"reportFrom\\":1,\\"advice\\":\\"离线受害资产\\",\\"count\\":\\""+$count+"\\",\\"reportStatus\\":0,\\"reportLevel\\":0,\\"reportTypeName\\":\\"数据窃取事件\\",\\"analyzePro\\":\\"专家分析\\",\\"reportType\\":5,\\"reportDesc\\":\\"SUSSC2\\",\\"ruleName\\":\\"演示例子10\\",\\"isBanned\\":\\"0\\",\\"ruleId\\":\\"ff80808176e0ec700176fec52f7f06f6\\"}");\nend\n',status:0},{updateUserName:"管理员",typeName:"",count:33,updateUser:"1",modelMap:'{"id":"ff80808176e0ec700176fae66fac06f4","name":"生产办公区与外部的位置检测到可疑行为类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"可疑行为","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到可疑行为类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"2021-01-28 14:59:33",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:2,isExtend:!1,createTime:"2021-01-13 16:39:42",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae66fac06f4",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到可疑行为类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "可疑行为" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到可疑行为类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到可疑行为类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae66fac06f4\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:30,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae61ba706f3","name":"生产办公区与外部的位置检测到缓冲溢出类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"缓冲溢出","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到缓冲溢出类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:39:21",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae61ba706f3",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到缓冲溢出类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "缓冲溢出" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到缓冲溢出类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到缓冲溢出类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae61ba706f3\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:21,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae5cbb006f2","name":"生产办公区与外部的位置检测到反序列化类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"反序列化","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到反序列化类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:39:00",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae5cbb006f2",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到反序列化类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "反序列化" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到反序列化类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到反序列化类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae5cbb006f2\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:23,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae57ae806f1","name":"生产办公区与外部的位置检测到FTP服务器溢出攻击类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"FTP服务器溢出攻击","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到FTP服务器溢出攻击类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:38:40",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae57ae806f1",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到FTP服务器溢出攻击类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "FTP服务器溢出攻击" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到FTP服务器溢出攻击类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到FTP服务器溢出攻击类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae57ae806f1\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:21,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae527e806f0","name":"生产办公区与外部的位置检测到第三方应用攻击类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"第三方应用攻击","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到第三方应用攻击类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:38:19",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae527e806f0",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到第三方应用攻击类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "第三方应用攻击" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到第三方应用攻击类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到第三方应用攻击类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae527e806f0\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:118,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae4d1ea06ef","name":"生产办公区与外部的位置检测到拒绝服务类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"拒绝服务","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到拒绝服务类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:37:57",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae4d1ea06ef",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到拒绝服务类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "拒绝服务" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到拒绝服务类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到拒绝服务类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae4d1ea06ef\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:52,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae4819a06ee","name":"生产办公区与外部的位置检测到安全漏洞A组类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"安全漏洞A组","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到安全漏洞A组类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:37:37",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae4819a06ee",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到安全漏洞A组类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "安全漏洞A组" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到安全漏洞A组类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到安全漏洞A组类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae4819a06ee\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:26,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae4308a06ed","name":"生产办公区与外部的位置检测到安全漏洞B组类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"安全漏洞B组","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到安全漏洞B组类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:37:15",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae4308a06ed",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到安全漏洞B组类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "安全漏洞B组" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到安全漏洞B组类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到安全漏洞B组类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae4308a06ed\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:25,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae3e22606ec","name":"生产办公区与外部的位置检测到网络扫描类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"网络扫描","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到网络扫描类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:36:55",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae3e22606ec",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到网络扫描类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "网络扫描" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到网络扫描类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到网络扫描类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae3e22606ec\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:30,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae3930806eb","name":"生产办公区与外部的位置检测到安全审计类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"安全审计","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到安全审计类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:36:34",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae3930806eb",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到安全审计类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "安全审计" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到安全审计类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到安全审计类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae3930806eb\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:48,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae343c306ea","name":"生产办公区与外部的位置检测到间谍软件类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"间谍软件","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到间谍软件类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:36:14",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae343c306ea",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到间谍软件类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "间谍软件" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到间谍软件类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到间谍软件类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae343c306ea\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:55,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae2ed9b06e9","name":"生产办公区与外部的位置检测到木马后门A组类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"木马后门A组","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到木马后门A组类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:35:53",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae2ed9b06e9",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到木马后门A组类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "木马后门A组" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到木马后门A组类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到木马后门A组类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae2ed9b06e9\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:26,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae2994f06e8","name":"生产办公区与外部的位置检测到网安设备攻击类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"网安设备攻击","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到网安设备攻击类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:35:32",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae2994f06e8",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到网安设备攻击类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "网安设备攻击" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到网安设备攻击类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到网安设备攻击类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae2994f06e8\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:30,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae2499306e7","name":"生产办公区与外部的位置检测到错误信息泄露类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"错误信息泄露","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到错误信息泄露类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:35:12",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae2499306e7",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到错误信息泄露类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "错误信息泄露" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到错误信息泄露类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到错误信息泄露类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae2499306e7\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:25,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae1f5f206e6","name":"生产办公区与外部的位置检测到分布式拒绝服务类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"分布式拒绝服务","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到分布式拒绝服务类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:34:51",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae1f5f206e6",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到分布式拒绝服务类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "分布式拒绝服务" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到分布式拒绝服务类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到分布式拒绝服务类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae1f5f206e6\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:21,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae1a43f06e5","name":"生产办公区与外部的位置检测到间谍软件攻击类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"间谍软件攻击","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到间谍软件攻击类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:34:29",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae1a43f06e5",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到间谍软件攻击类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "间谍软件攻击" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到间谍软件攻击类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到间谍软件攻击类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae1a43f06e5\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:32,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae1549e06e4","name":"生产办公区与外部的位置检测到木马后门B组类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"木马后门B组","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到木马后门B组类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:34:09",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae1549e06e4",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到木马后门B组类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "木马后门B组" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到木马后门B组类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到木马后门B组类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae1549e06e4\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:29,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae1046306e3","name":"生产办公区与外部的位置检测到常见WEB防护和入侵防御绕过类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"常见WEB防护和入侵防御绕过","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到常见WEB防护和入侵防御绕过类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:33:47",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae1046306e3",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到常见WEB防护和入侵防御绕过类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "常见WEB防护和入侵防御绕过" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到常见WEB防护和入侵防御绕过类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到常见WEB防护和入侵防御绕过类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae1046306e3\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1},{updateUserName:"",typeName:"",count:32,updateUser:"",modelMap:'{"id":"ff80808176e0ec700176fae0b30006e2","name":"生产办公区与外部的位置检测到安全漏洞C组类行为","extends":"","typeId":"","des":"","status":1,"mark":1,"define":"","sourceList":[{"type":1,"countMap":{"factType":"LinkedList","note":"","constraintList":[{"constraintName":"size","operator":">=","value":1,"fieldBindName":"$count","junctionType":"","dataType":"0","constraintList":[]}]},"factMap":{"factType":"AlarmEvent","window":"","after":"","objBindName":"","junctionType":"","note":"","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[]},{"constraintName":"labels","operator":"contains","value":"安全漏洞C组","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"||","dataType":"0","constraintList":[{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:生产区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]},{"constraintName":"","operator":"","value":"","fieldBindName":"","junctionType":"&&","dataType":"0","constraintList":[{"constraintName":"srcIp","operator":"not in","value":"(\\"$$:内网集合\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]},{"constraintName":"desIp","operator":"in","value":"(\\"$$:办公区\\")","fieldBindName":"","junctionType":"","dataType":"0","constraintList":[]}]}]}]}]}}],"thenList":[{"key":"reportType","reportTypeName":"危害关键服务与设施事件","value":15},{"key":"reportName","value":"生产办公区与外部的位置检测到安全漏洞C组类行为"},{"key":"reportLevel","value":"3"},{"key":"reportStatus","value":"0"},{"key":"advice","value":""},{"key":"analyzePro","value":""},{"key":"sendFlow","value":""},{"key":"assetIp","value":""},{"key":"asset","value":""},{"key":"reportDesc","value":""},{"key":"count","value":""},{"key":"attackResult","value":""},{"key":"isBanned","value":"0"},{"key":"timeQua","value":""},{"key":"condition-1","value":""}],"noticeMap":{"noticeType":[],"noticeUser":[],"userIds":""}}',updateTime:"",createUserName:"管理员",alarm7Num:[0,0,0,0,0,0,0],version:0,isExtend:!1,createTime:"2021-01-13 16:33:26",typeId:"",createUser:"1",id:"ff80808176e0ec700176fae0b30006e2",drl:'package rules;\n\nrule "生产办公区与外部的位置检测到安全漏洞C组类行为"\n\tdialect "mvel"\n\twhen\n\t\tLinkedList( $count : size >= 1 ) from collect ( \t\tAlarmEvent( ( labels contains "安全漏洞C组" )&& ( ( ( srcIp memberOf (poolmap.get("生产区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp memberOf (poolmap.get("办公区")) )&& ( desIp not memberOf (poolmap.get("内网集合")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("生产区")) ))|| ( ( srcIp not memberOf (poolmap.get("内网集合")) )&& ( desIp memberOf (poolmap.get("办公区")) )))) from entry-point "alarmEventEntry"\n) \n\tthen\n\t\tkafkaTemplate.send("report-topic", "{\\"msg\\":\\""+JSON.toJSONString(drools.getTuple().toObjects()).replace("\\"","\\\\\\"")+"\\",\\"reportType\\":15,\\"reportName\\":\\"生产办公区与外部的位置检测到安全漏洞C组类行为\\",\\"reportFrom\\":1,\\"ruleName\\":\\"生产办公区与外部的位置检测到安全漏洞C组类行为\\",\\"reportStatus\\":0,\\"isBanned\\":\\"0\\",\\"reportLevel\\":3,\\"ruleId\\":\\"ff80808176e0ec700176fae0b30006e2\\",\\"reportTypeName\\":\\"危害关键服务与设施事件\\"}");\nend\n',status:1}],totalElements:677},code:1,message:"success"}}});